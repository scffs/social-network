var e=Object.defineProperty,r=Object.defineProperties,s=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,i=(r,s,t)=>s in r?e(r,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[s]=t,n=(e,r)=>{for(var s in r||(r={}))o.call(r,s)&&i(e,s,r[s]);if(t)for(var s of t(r))a.call(r,s)&&i(e,s,r[s]);return e};import{j as l,r as p,u as d,h as c}from"./index-aaf2ae70.js";import{D as m,B as u}from"./index-172ff7f5.js";import{c as h,F as j}from"./FlexBetween-37d3138b.js";import{W as x}from"./WidgetWrapper-e2809c26.js";import{U as f}from"./UserImage-a476862e.js";import{I as v}from"./InputBase-6712dce2.js";import{B as b}from"./useMediaQuery-14101100.js";import{u as g,T as y}from"./Typography-89d80a21.js";import{I as O}from"./IconButton-b7fcdf7a.js";import{D as w}from"./Divider-9a172cb2.js";import{u as P}from"./useDispatch-5cd579e2.js";import"./App-db70bfcd.js";import"./ButtonBase-91a4f99f.js";import"./dividerClasses-82b3a2b4.js";const k=h(l.jsx("path",{d:"M16 9v10H8V9h8m-1.5-6h-5l-1 1H5v2h14V4h-3.5l-1-1zM18 7H6v12c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7z"}),"DeleteOutlined"),I=h(l.jsx("path",{d:"m14.06 9.02.92.92L5.92 19H5v-.92l9.06-9.06M17.66 3c-.25 0-.51.1-.7.29l-1.83 1.83 3.75 3.75 1.83-1.83c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.2-.2-.45-.29-.71-.29zm-3.6 3.19L3 17.25V21h3.75L17.81 9.94l-3.75-3.75z"}),"EditOutlined"),B=h(l.jsx("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-4.86 8.86-3 3.87L9 13.14 6 17h12l-3.86-5.14z"}),"ImageOutlined"),D=({picturePath:e})=>{const t=P(),[o,a]=p.useState(!1),[i,h]=p.useState(null),[D,z]=p.useState(""),{palette:C}=g(),H=d((e=>e.user)),M=d((e=>e.token)),V=null==H?void 0:H._id,{mediumMain:S,medium:L}=C.neutral;return l.jsxs(x,{children:[l.jsxs(j,{gap:"1.5rem",children:[l.jsx(f,{image:e}),l.jsx(v,{placeholder:"Пишите о чём угодно",onChange:e=>z(e.target.value),value:D,sx:{width:"100%",backgroundColor:C.neutral.light,borderRadius:"2rem",padding:"1rem 2rem"}})]}),o&&l.jsx(b,{border:`1px solid ${L}`,borderRadius:"5px",mt:"1rem",p:"1rem",children:l.jsx(m,{multiple:!1,onDrop:e=>h(e[0]),children:({getRootProps:e,getInputProps:t})=>{return l.jsxs(j,{children:[l.jsxs(b,(o=n({},e()),a={border:`2px dashed ${C.primary.main}`,p:"1rem",width:"100%",sx:{"&:hover":{cursor:"pointer"}},children:[l.jsx("input",n({},t())),i?l.jsxs(j,{children:[l.jsx(y,{children:i.name}),l.jsx(I,{})]}):l.jsx("p",{children:"Загрузить изображение"})]},r(o,s(a)))),i&&l.jsx(O,{onClick:()=>h(null),sx:{width:"15%"},children:l.jsx(k,{})})]});var o,a}})}),l.jsx(w,{sx:{margin:"1.25rem 0"}}),l.jsxs(j,{children:[l.jsxs(j,{gap:"0.25rem",onClick:()=>a(!o),children:[l.jsx(B,{sx:{color:S}}),l.jsx(y,{color:S,sx:{"&:hover":{cursor:"pointer",color:L}},children:"Изображение"})]}),l.jsx(u,{disabled:!D,onClick:()=>{return e=void 0,r=null,s=function*(){const e=new FormData;V&&e.append("userId",V),e.append("description",D),i&&(e.append("picture",i),e.append("picturePath",i.name));const r=yield fetch("https://scffs.github.io/social-network/posts",{method:"POST",headers:{Authorization:`Bearer ${M}`},body:e}),s=yield r.json();t(c({posts:s})),h(null),z("")},new Promise(((t,o)=>{var a=e=>{try{n(s.next(e))}catch(e){o(e)}},i=e=>{try{n(s.throw(e))}catch(e){o(e)}},n=e=>e.done?t(e.value):Promise.resolve(e.value).then(a,i);n((s=s.apply(e,r)).next())}));var e,r,s},sx:{color:C.background.default,backgroundColor:C.primary.dark,borderRadius:"3rem"},children:"Опубликовать"})]})]})};export{D as default};
